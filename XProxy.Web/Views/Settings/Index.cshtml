@using XProxy.Domain;
@model Dictionary<string, object>

@{
    ViewData["Title"] = "Dashboard";
    var accessDate = ((AV100ResponseProfile)Model["Status"]).Result.AccessTo.ToString("D");
    var leftClicks = ((AV100ResponseProfile)Model["Status"]).Result.LleftClicks;
}

<h1>@ViewData["Title"]</h1>
@*<hr style="padding-bottom: 25px;" />*@

<div class="card mb-5 mt-3">
    <h5 class="card-header">AV100 balance</h5>
    <div class="card-body">
        <h5 class="card-title">Account enabled till @accessDate</h5>
        <p class="card-text">Еhere are @leftClicks requests left on the balance</p>
        <a href="https://av100.ru" class="btn btn-info" target="_blank">go to AV100</a>
    </div>
</div>

@if (Model.ContainsKey("Settings") && ((ICollection<UserSettingsItem>)Model["Settings"]).Count > 0)
{
    <h2>API Settings</h2>
    <table class="table">
        <thead class=".thead-dark">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">XL API key</th>
                <th scope="col">XL url</th>
                <th scope="col">AV100 API key</th>
                <th scope="col">Interval</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            @{
                foreach (var item in (ICollection<UserSettingsItem>)Model["Settings"])
                {
                    <tr>
                        <th scope="row">@item.Id</th>
                        <td>@item.XLombardToken</td>
                        <td>@item.XLombardAPIUrl</td>
                        <td>@item.Av100Token</td>
                        <td>@item.UpdateInterval</td>
                        <td>@Html.ActionLink("Edit", "Edit", "Settings", new { id = item.Id }, new { @class = "btn btn-primary" })</td>
                    </tr>
                }
            }
        </tbody>
    </table>

}
else
{
    <div class="callout callout-warning">
        <h2>There are no API connections</h2>
        <p>click <a href="/settings/create" class="btn btn-primary">Create</a> to start configuring it</p>
    </div>
}
<br />
@if (Model.ContainsKey("Filter") && ((ICollection<AV100FilterItem>)Model["Filter"]).Count > 0)
    {
    <h2>API Settings</h2>
    <table class="table">
        <thead class=".thead-dark">
            <tr>
                <th scope="col">Year start</th>
                <th scope="col">Year end</th>
                <th scope="col">Price start</th>
                <th scope="col">Price end</th>
                <th scope="col">Distance start</th>
                <th scope="col">Distance end</th>
                <th scope="col">Car count</th>
                <th scope="col">Phone count</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            @{
                foreach (var fitem in (ICollection<AV100FilterItem>)Model["Filter"])
                {
                    <tr>
                        <th scope="row">@fitem.Id</th>
                        <td>@fitem.YearStart</td>
                        <td>@fitem.YearEnd</td>
                        <td>@fitem.PriceStart</td>
                        <td>@fitem.PriceEnd</td>
                        <td>@fitem.DistanceStart</td>
                        <td>@fitem.DistanceEnd</td>
                        <td>@fitem.CarCount</td>
                        <td>@fitem.PhoneCount</td>
                        <td>@Html.ActionLink("Edit", "Edit", "Filter", new { id = fitem.Id }, new { @class = "btn btn-primary" })</td>
                    </tr>
                }
            }
        </tbody>
    </table>

}
else
{
    <div class="callout callout-warning">
        <h2>There are no filter</h2>
        <p>click <a href="/filter/create" class="btn btn-primary">Create</a> to start configuring it</p>
    </div>
}
